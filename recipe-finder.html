<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>Recipe Finder ‚Äî Nick Isteepho</title>
  <link rel="stylesheet" href="style.css"/>
  <style>
    /* Page scope */
    .rf-wrap{max-width:1100px;margin:90px auto 48px;padding:0 20px}
    .tabs{display:flex;gap:10px;margin-bottom:12px}
    .tab{padding:8px 12px;border:1px solid rgba(255,255,255,.15);border-radius:10px;cursor:pointer}
    .tab[aria-selected="true"]{border-color:var(--accent)}

    .rf-grid{display:grid;grid-template-columns:320px 1fr;gap:16px}
    @media (max-width:980px){.rf-grid{grid-template-columns:1fr}}

    .card{background:var(--card);border:1px solid rgba(255,255,255,.1);border-radius:14px;padding:14px}
    .row{display:flex;gap:8px;flex-wrap:wrap;align-items:center}
    .input,.select{width:100%;padding:10px 12px;border-radius:10px;border:1px solid rgba(255,255,255,.14);background:transparent;color:var(--fg)}
    body:not(.dark) .input,body:not(.dark) .select{border-color:#e6e7ef;color:#111}
    .btn{padding:10px 14px;border-radius:10px;border:1px solid var(--accent);background:transparent;color:var(--fg);cursor:pointer}
    .btn.primary{background:var(--accent);color:#fff;border-color:var(--accent)}

    .results{display:grid;grid-template-columns:repeat(auto-fill,minmax(260px,1fr));gap:14px}
    .recipe{display:flex;flex-direction:column;gap:8px;background:var(--card);border:1px solid rgba(255,255,255,.1);border-radius:14px;padding:12px}
    .recipe h4{margin:0}
    .meta{font-size:13px;color:var(--muted)}
    .tag{display:inline-block;margin-right:6px;margin-top:6px;font-size:12px;border-radius:999px;border:1px solid rgba(255,255,255,.16);padding:4px 8px;color:var(--muted)}

    /* Meal plan */
    .plan-wrap{overflow-x:auto;padding-bottom:6px}
    .plan{display:grid;grid-template-columns:repeat(7,minmax(160px,1fr));gap:10px;min-width:1120px}
    .day{background:var(--card);border:1px solid rgba(255,255,255,.1);border-radius:12px;padding:10px;min-height:140px}
    .day h5{margin:0 0 6px}
    .pill{display:inline-flex;align-items:center;gap:6px;margin:6px 0;padding:6px 8px;border-radius:10px;border:1px solid rgba(255,255,255,.16);font-size:12px}
    .pill button{border:none;background:transparent;color:var(--muted);cursor:pointer}

    .empty{color:var(--muted);text-align:center;padding:20px;border:1px dashed rgba(255,255,255,.2);border-radius:10px}
    .mini{font-size:12px;color:var(--muted)}
    .home-icon:hover{ background: rgba(255,255,255,0.08); border-radius:50%; }
  </style>
</head>
<body class="dark">
  <header class="wrap culinary-header">
    <a href="index.html" class="home-icon" title="Back to Home">‚åÇ</a>
    <div class="header-text">
      <h1>Recipe Finder</h1>
      <p class="sub">Clean list, simple filters, solid meal plan. Clicking a recipe opens its own page.</p>
    </div>
  </header>

  <main class="rf-wrap">
    <div class="tabs">
      <button class="tab" id="tab-search" aria-selected="true">Search</button>
      <button class="tab" id="tab-plan" aria-selected="false">Meal Plan</button>
    </div>

    <!-- SEARCH VIEW -->
    <section id="view-search">
      <div class="rf-grid">
        <!-- Filters -->
        <aside class="card">
          <h3>Find Recipes</h3>
          <input id="q" class="input" placeholder="Search (name, ingredient, tag)‚Ä¶"/>
          <div class="row" style="margin-top:8px">
            <select id="diet" class="select">
              <option value="">Any diet</option>
              <option value="vegan">Vegan</option>
              <option value="vegetarian">Vegetarian</option>
              <option value="gluten-free">Gluten-free</option>
            </select>
            <select id="course" class="select">
              <option value="">Any course</option>
              <option>Breakfast</option><option>Lunch</option><option>Dinner</option><option>Snack</option>
            </select>
          </div>
          <div class="row" style="margin-top:8px">
            <select id="difficulty" class="select">
              <option value="">Any difficulty</option>
              <option>Easy</option><option>Medium</option><option>Hard</option>
            </select>
            <select id="time" class="select">
              <option value="">Any time</option>
              <option value="15">‚â§ 15 min</option>
              <option value="30">‚â§ 30 min</option>
              <option value="45">‚â§ 45 min</option>
              <option value="60">‚â§ 60 min</option>
            </select>
          </div>
          <div class="row" style="margin-top:8px">
            <input id="pantry" class="input" placeholder="Pantry to match (comma: chicken, basil)"/>
            <select id="sort" class="select">
              <option value="relevance">Sort: Relevance</option>
              <option value="time">Quickest</option>
            </select>
          </div>
          <div class="row" style="margin-top:8px">
            <button id="search" class="btn primary">Search</button>
            <button id="showAll" class="btn">Show All</button>
          </div>
          <p class="mini" style="margin-top:8px">Tip: click a result‚Äôs **Open** to view it on its own page.</p>
        </aside>

        <!-- Results -->
        <section class="card">
          <div class="row" style="justify-content:space-between;align-items:center;margin-bottom:6px">
            <div class="mini">Results: <strong id="count">0</strong></div>
            <button id="goPlan" class="btn">Go to Meal Plan</button>
          </div>
          <div id="results" class="results"></div>
          <div id="empty" class="empty">Search to see recipes, or press ‚ÄúShow All‚Äù.</div>
        </section>
      </div>
    </section>

    <!-- PLAN VIEW -->
    <section id="view-plan" hidden>
      <div class="card">
        <div class="row" style="justify-content:space-between;align-items:center">
          <h3>Meal Plan</h3>
          <div class="row">
            <button id="shopList" class="btn primary">Build Shopping List</button>
            <button id="clearPlan" class="btn">Clear</button>
          </div>
        </div>
        <div class="plan-wrap">
          <div id="plan" class="plan"></div>
        </div>
      </div>
    </section>
  </main>

  <script>
  /* Shared demo data (duplicate in recipe.html too) */
  const RECIPES = [
    { id:"pasta-basil-chicken", title:"Chicken Tomato Basil Pasta",
      course:"Dinner", difficulty:"Easy", time:25, servings:2, diet:[], tags:["pasta","basil","weeknight"],
      ingredients:[
        { qty:160, unit:"g", item:"pasta" },
        { qty:250, unit:"g", item:"chicken breast" },
        { qty:1, unit:"tbsp", item:"olive oil" },
        { qty:2, unit:"cloves", item:"garlic" },
        { qty:1, unit:"piece", item:"onion" },
        { qty:2, unit:"piece", item:"tomato" },
        { qty:8, unit:"leaves", item:"basil" },
        { qty:20, unit:"g", item:"parmesan" }
      ],
      steps:[
        "Boil salted water; cook pasta al dente.",
        "Saut√© onion and garlic in oil; add diced chicken; cook through.",
        "Add chopped tomatoes; simmer; toss with pasta and basil.",
        "Finish with grated parmesan."
      ]
    },
    { id:"spinach-omelet", title:"Spinach & Parmesan Omelet",
      course:"Breakfast", difficulty:"Easy", time:10, servings:1, diet:["gluten-free"], tags:["high-protein","quick"],
      ingredients:[{qty:2,unit:"piece",item:"egg"},{qty:40,unit:"g",item:"spinach"},{qty:10,unit:"g",item:"parmesan"},{qty:5,unit:"g",item:"butter"}],
      steps:["Beat eggs; melt butter; add egg; scatter spinach and parmesan; fold."] },
    { id:"tofu-broccoli-stirfry", title:"Ginger Soy Tofu & Broccoli",
      course:"Dinner", difficulty:"Medium", time:20, servings:2, diet:["vegan","gluten-free"], tags:["stir-fry","easy"],
      ingredients:[{qty:300,unit:"g",item:"tofu"},{qty:200,unit:"g",item:"broccoli"},{qty:1,unit:"tbsp",item:"soy sauce"},{qty:10,unit:"g",item:"ginger"},{qty:1,unit:"tbsp",item:"olive oil"}],
      steps:["Stir-fry ginger in oil; add tofu; add broccoli; splash soy; serve hot."] },
    { id:"lemon-salmon", title:"Lemon Butter Salmon",
      course:"Dinner", difficulty:"Easy", time:18, servings:2, diet:["gluten-free"], tags:["omega-3","sheet-pan"],
      ingredients:[{qty:320,unit:"g",item:"salmon"},{qty:10,unit:"g",item:"butter"},{qty:1,unit:"piece",item:"lemon"},{qty:1,unit:"clove",item:"garlic"}],
      steps:["Season salmon; dot with butter and garlic; bake 12‚Äì14 min; finish with lemon."] },
    { id:"banana-oat-pancakes", title:"Banana Oat Pancakes",
      course:"Breakfast", difficulty:"Medium", time:20, servings:2, diet:["vegetarian"], tags:["oats","no-refined-sugar"],
      ingredients:[{qty:1,unit:"piece",item:"banana"},{qty:90,unit:"g",item:"oats"},{qty:1,unit:"piece",item:"egg"},{qty:120,unit:"ml",item:"milk"},{qty:5,unit:"g",item:"butter"}],
      steps:["Blend banana, oats, egg, milk; rest; pan-fry with butter; serve."] },
    { id:"garlic-egg-fried-rice", title:"Garlic Egg Fried Rice",
      course:"Lunch", difficulty:"Easy", time:15, servings:2, diet:[], tags:["pantry","fast"],
      ingredients:[{qty:150,unit:"g",item:"rice"},{qty:2,unit:"piece",item:"egg"},{qty:2,unit:"cloves",item:"garlic"},{qty:1,unit:"tbsp",item:"soy sauce"},{qty:1,unit:"tbsp",item:"olive oil"}],
      steps:["Cook rice (or use day-old). Fry garlic, egg; add rice, soy; toss 2‚Äì3 min."] },
    { id:"chickpea-cucumber-salad", title:"Chickpea Cucumber Feta Salad",
      course:"Lunch", difficulty:"Easy", time:12, servings:2, diet:["vegetarian"], tags:["fresh","no-cook"],
      ingredients:[{qty:150,unit:"g",item:"chickpeas"},{qty:1,unit:"piece",item:"cucumber"},{qty:40,unit:"g",item:"feta"},{qty:1,unit:"tbsp",item:"olive oil"},{qty:1,unit:"piece",item:"lemon"}],
      steps:["Chop cucumber; toss with chickpeas, feta, oil, lemon; season to taste."] },
    { id:"quinoa-bowl", title:"Quinoa Power Bowl",
      course:"Dinner", difficulty:"Medium", time:25, servings:2, diet:["vegetarian","gluten-free"], tags:["balanced","meal-prep"],
      ingredients:[{qty:160,unit:"g",item:"quinoa"},{qty:100,unit:"g",item:"spinach"},{qty:1,unit:"piece",item:"tomato"},{qty:40,unit:"g",item:"feta"},{qty:1,unit:"tbsp",item:"olive oil"}],
      steps:["Cook quinoa; wilt spinach; assemble bowl with tomato, feta, oil."] }
  ];

  /* State */
  const days = ["Mon","Tue","Wed","Thu","Fri","Sat","Sun"];
  let plan = JSON.parse(localStorage.getItem("rf_plan")||"{}"); if (Object.keys(plan).length===0){ days.forEach(d=> plan[d]=[]); }
  const $results = document.getElementById("results");
  const $count = document.getElementById("count");
  const $empty = document.getElementById("empty");
  const $planBox = document.getElementById("plan");

  /* Simple search (clean + predictable) */
  function runSearch(){
    const q = document.getElementById("q").value.trim().toLowerCase();
    const diet = document.getElementById("diet").value;
    const course = document.getElementById("course").value;
    const diff = document.getElementById("difficulty").value;
    const time = parseInt(document.getElementById("time").value||"0",10) || Infinity;
    const pantry = new Set((document.getElementById("pantry").value||"").toLowerCase().split(",").map(s=>s.trim()).filter(Boolean));
    let list = RECIPES.filter(r=>{
      if (diet && !r.diet.includes(diet)) return false;
      if (course && r.course!==course) return false;
      if (diff && r.difficulty!==diff) return false;
      if (r.time > time) return false;
      const text = (r.title+" "+r.tags.join(" ")+" "+r.ingredients.map(i=>i.item).join(" ")).toLowerCase();
      if (q && !text.includes(q)) return false;
      // pantry bias computed later
      return true;
    }).map(r=>{
      const need = new Set(r.ingredients.map(i=>i.item));
      let have = 0; need.forEach(i=>{ if (pantry.has(i)) have++; });
      const fit = pantry.size ? Math.round((have/need.size)*100) : 0;
      return {...r, _fit: fit};
    });

    const sort = document.getElementById("sort").value;
    list.sort((a,b)=>{
      if (sort==="time") return a.time - b.time;
      // relevance: pantry fit + simple title hit
      const aR = a._fit + (q && a.title.toLowerCase().includes(q) ? 20 : 0);
      const bR = b._fit + (q && b.title.toLowerCase().includes(q) ? 20 : 0);
      return bR - aR;
    });

    renderList(list);
  }

  function renderList(list){
    $results.innerHTML = "";
    $count.textContent = list.length;
    $empty.style.display = list.length ? "none" : "block";
    list.forEach(r=>{
      const card = document.createElement("div");
      card.className = "recipe";
      card.innerHTML = `
        <h4>${r.title}</h4>
        <div class="meta">${r.course} ‚Ä¢ ${r.difficulty} ‚Ä¢ ${r.time} min ‚Ä¢ serves ${r.servings}</div>
        <div class="mini">Pantry fit: <strong>${r._fit||0}%</strong></div>
        <div>${r.tags.map(t=>`<span class="tag">#${t}</span>`).join("")}</div>
        <div class="row">
          <a class="btn primary" href="recipe.html?id=${r.id}">Open</a>
          <button class="btn" data-add="${r.id}">Add to Plan</button>
        </div>
      `;
      card.querySelector(`[data-add="${r.id}"]`).addEventListener("click", ()=>{
        // add to first slot with <2 items
        const day = (["Mon","Tue","Wed","Thu","Fri","Sat","Sun"].find(d=> (plan[d]||[]).length<2)) || "Mon";
        plan[day] = plan[day] || [];
        plan[day].push(r.id);
        localStorage.setItem("rf_plan", JSON.stringify(plan));
        alert(`Added to ${day}`);
      });
      $results.appendChild(card);
    });
  }

  /* Meal plan */
  function renderPlan(){
    $planBox.innerHTML = "";
    days.forEach(d=>{
      const box = document.createElement("div");
      box.className = "day";
      box.innerHTML = `<h5>${d}</h5>`;
      (plan[d]||[]).forEach(id=>{
        const r = RECIPES.find(x=>x.id===id);
        const pill = document.createElement("div");
        pill.className="pill";
        pill.innerHTML = `<span>üçΩÔ∏è</span><a href="recipe.html?id=${id}">${r.title}</a><button data-remove="${d}|${id}">‚úï</button>`;
        box.appendChild(pill);
      });
      if (!plan[d] || !plan[d].length){
        const small = document.createElement("div");
        small.className="mini"; small.textContent="No recipes yet";
        box.appendChild(small);
      }
      $planBox.appendChild(box);
    });
  }

  document.getElementById("plan").addEventListener("click", (e)=>{
    const key = e.target?.dataset?.remove;
    if (!key) return;
    const [day,id] = key.split("|");
    plan[day] = (plan[day]||[]).filter(x=>x!==id);
    localStorage.setItem("rf_plan", JSON.stringify(plan));
    renderPlan();
  });

  /* Tabs */
  const $tabSearch = document.getElementById("tab-search");
  const $tabPlan = document.getElementById("tab-plan");
  function showSearch(){ document.getElementById("view-search").hidden=false; document.getElementById("view-plan").hidden=true; $tabSearch.setAttribute("aria-selected","true"); $tabPlan.setAttribute("aria-selected","false"); }
  function showPlan(){ document.getElementById("view-search").hidden=true; document.getElementById("view-plan").hidden=false; $tabSearch.setAttribute("aria-selected","false"); $tabPlan.setAttribute("aria-selected","true"); renderPlan(); }
  $tabSearch.addEventListener("click", showSearch);
  $tabPlan.addEventListener("click", showPlan);
  document.getElementById("goPlan").addEventListener("click", showPlan);

  /* Buttons */
  document.getElementById("search").addEventListener("click", runSearch);
  document.getElementById("showAll").addEventListener("click", ()=> renderList(RECIPES));
  document.getElementById("shopList").addEventListener("click", ()=>{
    const needed = {};
    for (const d of days){
      for (const id of (plan[d]||[])){
        const r = RECIPES.find(x=>x.id===id); if (!r) continue;
        r.ingredients.forEach(ing=>{
          const key = ing.item+"|"+(ing.unit||"g").toLowerCase();
          if (!needed[key]) needed[key] = { item:ing.item, unit:(ing.unit||"g").toLowerCase(), qty:0 };
          needed[key].qty += ing.qty;
        });
      }
    }
    const lines = Object.values(needed).sort((a,b)=>a.item.localeCompare(b.item)).map(i=>`${Math.round(i.qty*10)/10} ${i.unit} ${i.item}`);
    if (!lines.length){ alert("Plan is empty."); return; }
    navigator.clipboard?.writeText(lines.join("\n"));
    alert("Shopping list copied to clipboard.");
  });
  document.getElementById("clearPlan").addEventListener("click", ()=>{
    days.forEach(d=> plan[d]=[]);
    localStorage.setItem("rf_plan", JSON.stringify(plan));
    renderPlan();
  });

  // Init
  renderList(RECIPES);
  renderPlan();
  </script>
</body>
</html>
